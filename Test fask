local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer

-- ğŸ“Œ Webhook Discord (Thay báº±ng link webhook cá»§a báº¡n)
local WebhookURL = "https://discord.com/api/webhooks/1353331618802044928/HWkDOTGUkOz_IWQGzdYVz-7aK75-R5yDN07Lw2PIpNkeo3Szj6Gv2N5S3sdWwGcXEDfj"

-- ğŸ“Œ Hiá»ƒn thá»‹ thÃ´ng bÃ¡o trÃªn mÃ n hÃ¬nh
local function showNotification(title, text, duration)
    StarterGui:SetCore("SendNotification", {
        Title = title;
        Text = text;
        Duration = duration;
    })
end

-- ğŸ“Œ Gá»­i thÃ´ng bÃ¡o Ä‘áº¿n Discord Webhook
local function sendDiscordMessage(fruitName, fruitPosition)
    local data = {
        ["username"] = "Plow Hub | Auto Fruit",
        ["embeds"] = {{
            ["title"] = "ğŸ TÃ¬m tháº¥y trÃ¡i Ã¡c quá»·!",
            ["description"] = "**TÃªn TrÃ¡i:** " .. fruitName .. "\n**Vá»‹ trÃ­:** " .. tostring(fruitPosition),
            ["color"] = 16711680 -- MÃ u Ä‘á»
        }}
    }

    local jsonData = HttpService:JSONEncode(data)
    HttpService:PostAsync(WebhookURL, jsonData, Enum.HttpContentType.ApplicationJson)
end

-- ğŸ“Œ Láº¥y danh sÃ¡ch server chá»‰ á»Ÿ Singapore ğŸ‡¸ğŸ‡¬
local function getSingaporeServers()
    local url = "https://games.roblox.com/v1/games/2753915549/servers/Public?sortOrder=Asc&limit=100"
    local success, response = pcall(function() return game:HttpGet(url) end)

    if not success then
        print("âŒ Lá»—i láº¥y danh sÃ¡ch server:", response)
        return {}
    end

    local data = HttpService:JSONDecode(response)
    local singaporeServers = {}

    for _, server in pairs(data.data) do
        if server.region == "Singapore" and server.playing < server.maxPlayers then
            table.insert(singaporeServers, server.id)
        end
    end

    return singaporeServers
end

-- ğŸ“Œ Äá»•i server (SiÃªu nhanh, chá»‰ Ä‘áº¿n server Singapore ğŸ‡¸ğŸ‡¬)
local function fastTeleportToSingaporeServer()
    local servers = getSingaporeServers()
    if #servers > 0 then
        local randomServer = servers[math.random(1, #servers)]
        print("âœ… Äang chuyá»ƒn Ä‘áº¿n server Singapore:", randomServer)
        showNotification("Plow Hub | Auto Fruit", "Äá»•i server siÃªu nhanh...", 2)
        TeleportService:TeleportToPlaceInstance(game.PlaceId, randomServer, LocalPlayer)
    else
        print("âŒ KhÃ´ng tÃ¬m tháº¥y server Singapore! Äá»•i server khÃ¡c...")
        showNotification("Plow Hub | Auto Fruit", "KhÃ´ng tÃ¬m tháº¥y server! Äang Ä‘á»•i server...", 2)
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end
end

-- ğŸ“Œ TÃ¬m trÃ¡i Ã¡c quá»· gáº§n nháº¥t vÃ  gá»­i webhook
local function findNearestFruit()
    for _, fruit in pairs(Workspace:GetChildren()) do
        if fruit:IsA("Model") and fruit.Name:find("Fruit") and fruit:FindFirstChild("Handle") then
            local fruitPosition = fruit.Handle.Position
            showNotification("Plow Hub | Auto Fruit", "ÄÃ£ tÃ¬m tháº¥y trÃ¡i " .. fruit.Name .. "!", 3)
            sendDiscordMessage(fruit.Name, fruitPosition)
            return true
        end
    end
    return false
end

-- ğŸ“Œ Kiá»ƒm tra ngay láº­p tá»©c náº¿u khÃ´ng cÃ³ trÃ¡i => Äá»•i server siÃªu nhanh
local function instantCheckAndSwitchServer()
    if not findNearestFruit() then
        print("âŒ KhÃ´ng cÃ³ trÃ¡i! Äá»•i server ngay láº­p tá»©c...")
        showNotification("Plow Hub | Auto Fruit", "KhÃ´ng cÃ³ trÃ¡i! Äá»•i server ngay...", 2)
        fastTeleportToSingaporeServer()
    else
        print("âœ… ÄÃ£ tÃ¬m tháº¥y trÃ¡i! KhÃ´ng cáº§n Ä‘á»•i server.")
    end
end

-- ğŸ“Œ Báº¯t Ä‘áº§u script
local function startScript()
    instantCheckAndSwitchServer() -- Kiá»ƒm tra ngay láº­p tá»©c
end

startScript()
