local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer

-- 📌 Webhook Discord (Thay bằng link webhook của bạn)
local WebhookURL = "https://discord.com/api/webhooks/1353331618802044928/HWkDOTGUkOz_IWQGzdYVz-7aK75-R5yDN07Lw2PIpNkeo3Szj6Gv2N5S3sdWwGcXEDfj"

-- 📌 Hiển thị thông báo trên màn hình
local function showNotification(title, text, duration)
    StarterGui:SetCore("SendNotification", {
        Title = title;
        Text = text;
        Duration = duration;
    })
end

-- 📌 Tạo UI hiển thị thông báo
local function createUI()
    local ScreenGui = Instance.new("ScreenGui")
    local Frame = Instance.new("Frame")
    local TextLabel = Instance.new("TextLabel")

    -- Thuộc tính của UI
    ScreenGui.Parent = game.CoreGui
    Frame.Parent = ScreenGui
    Frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Frame.BorderSizePixel = 2
    Frame.Position = UDim2.new(0.35, 0, 0.1, 0)
    Frame.Size = UDim2.new(0.3, 0, 0.1, 0)
    Frame.BackgroundTransparency = 0.5

    TextLabel.Parent = Frame
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Text = "🔍 Đang kiểm tra trái ác quỷ..."
    TextLabel.TextScaled = true
    TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TextLabel.BackgroundTransparency = 1

    return TextLabel
end

-- 📌 Gửi thông báo khi khởi động script
local function startupMessage(uiLabel)
    uiLabel.Text = "🔍 Đang kiểm tra trái ác quỷ..."
    showNotification("Plow Hub | Auto Fruit", "🚀 Đang tìm trái ác quỷ...", 5)
end

-- 📌 Tìm trái ác quỷ gần nhất và hiển thị trên UI
local function findNearestFruit(uiLabel)
    for _, fruit in pairs(Workspace:GetChildren()) do
        if fruit:IsA("Model") and fruit.Name:find("Fruit") and fruit:FindFirstChild("Handle") then
            local fruitPosition = fruit.Handle.Position
            showNotification("Plow Hub | Auto Fruit", "✅ Tìm thấy trái " .. fruit.Name, 3)
            uiLabel.Text = "✅ Tìm thấy trái: " .. fruit.Name
            return fruit
        end
    end
    uiLabel.Text = "❌ Không có trái ác quỷ"
    return nil
end

-- 📌 Đổi server nếu không có trái
local function switchServerAfterDelay(uiLabel)
    print("⏳ Không có trái, chờ 7 giây trước khi đổi server...")
    uiLabel.Text = "⏳ Không có trái! Chờ 7 giây..."
    showNotification("Plow Hub | Auto Fruit", "Không có trái! Đang chờ 7 giây...", 7)
    wait(7) -- Chờ 7 giây
    TeleportService:Teleport(game.PlaceId, LocalPlayer)
end

-- 📌 Tìm và lưu trữ trái, sau đó đổi server nếu cần
local function checkAndStoreFruit(uiLabel)
    local fruit = findNearestFruit(uiLabel)

    if fruit then
        showNotification("Plow Hub | Auto Fruit", "✅ Đang nhặt trái...", 3)
        uiLabel.Text = "✅ Đang nhặt trái..."
        -- Lưu trái vào kho (Giả lập nhặt trái)
        wait(3)
        showNotification("Plow Hub | Auto Fruit", "✅ Đã lưu trái vào kho!", 3)
        uiLabel.Text = "✅ Đã lưu trái vào kho!"
    else
        switchServerAfterDelay(uiLabel) -- Không có trái, chờ 7 giây rồi đổi server
    end
end

-- 📌 Bắt đầu script
local function startScript()
    local uiLabel = createUI() -- Tạo UI hiển thị thông báo
    startupMessage(uiLabel) -- Hiển thị thông báo khi chạy script
    checkAndStoreFruit(uiLabel) -- Tìm trái, lưu vào kho, đổi server
end

startScript()
